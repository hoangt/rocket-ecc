set -ex

CURVE="p256k1"
DIGEST="6b5dfcd5031a5fd18d9298421dfcf2da5320bea8524b26d2ca1419777207f2ea"
PUBKEY="044714D3011E0A0C10FAAFBF8E3E7109D4EE0C889708150D996E6DC09EDD8BCA4B7E65F63547156D9CC05A5F49DBA480006B527C5E44EC671215788C6CB3A46133"
PRIVKEY="0A01234E84E76FC75742E77BAD86E6C04053193CD5A48577E69E63695E7A96F6"
R="52E20AAFD11F711201A3AD9D15870D9F3197E6A82ED26DA87904516E8362FB4B"
S="89E1EBAD3105DCB44C76556B0A922C48BEE5B93875D1E5A72A74BEEACA6A6243"
RESULT="Success"

function verify()
{
    out="$($PTEST_BINARY --curve $CURVE --pubkey $PUBKEY --privkey $PRIVKEY --digest $DIGEST --r $R --s $S)"

    if [[ "$out" != "$RESULT" ]]
    then
        exit 1
    else
        exit 0
    fi
}

trap verify EXIT
